<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>BAMOS CHARTS</title>
  <!-- plugins:css -->
  <link rel="stylesheet" href="../../vendors/feather/feather.css">
  <link rel="stylesheet" href="../../vendors/mdi/css/materialdesignicons.min.css">
  <link rel="stylesheet" href="../../vendors/ti-icons/css/themify-icons.css">
  <link rel="stylesheet" href="../../vendors/typicons/typicons.css">
  <link rel="stylesheet" href="../../vendors/simple-line-icons/css/simple-line-icons.css">
  <link rel="stylesheet" href="../../vendors/css/vendor.bundle.base.css">
  <!-- endinject -->
  <!-- Plugin css for this page -->
  <!-- End plugin css for this page -->
  <!-- inject:css -->
  <link rel="stylesheet" href="../../css/vertical-layout-light/style.css">
  <!-- endinject -->
  <link rel="shortcut icon" href="../../images/favicon.png" />
</head>

<body>
  <div class="container-scroller">
    <!-- partial:../../partials/_navbar.html -->
    <nav class="navbar default-layout col-lg-12 col-12 p-0 fixed-top d-flex align-items-top flex-row">
      <div class="text-center navbar-brand-wrapper d-flex align-items-center justify-content-start">
        <div class="me-3">
          <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-bs-toggle="minimize">
            <span class="icon-menu"></span>
          </button>
        </div>
        <div>
          <a class="navbar-brand brand-logo" href="bamos-dashb-welcome-page.html">
            <img src="images/logo-2.png" alt="logo" />
          </a>
          <a class="navbar-brand brand-logo-mini" href="bamos-dashb-welcome-page.html">
            <img src="images/logo-2.png" alt="logo" />
          </a>
        </div>
      </div>
      <div class="navbar-menu-wrapper d-flex align-items-top"> 
        <ul class="navbar-nav">
          <li class="nav-item font-weight-semibold d-none d-lg-block ms-0">
            <h1 class="welcome-text">Good Day, <span class="fw-bold">ADMIN</span></h1>
          </li>
        </ul>
        <ul class="navbar-nav ms-auto">
          <li class="nav-item d-none d-lg-block">
            <div id="datepicker-popup" class="input-group date datepicker navbar-date-picker">
              <span class="input-group-addon input-group-prepend border-right">
                <span class="icon-calendar input-group-text calendar-icon"></span>
              </span>
              <input type="text" class="form-control">
            </div>
          </li>
          
          <li class="nav-item dropdown">
            <a class="nav-link count-indicator" id="countDropdown" href="#" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="icon-bell"></i>
              <span class="count"></span>
            </a>
            <div class="dropdown-menu dropdown-menu-right navbar-dropdown preview-list pb-0" aria-labelledby="notificationDropdown" id="notification-list">
              
              
            </div>
          </li>

          <li class="nav-item dropdown d-none d-lg-block user-dropdown">
            <a class="nav-link" id="UserDropdown" href="#" data-bs-toggle="dropdown" aria-expanded="false">
              Admin </a>
            <div class="dropdown-menu dropdown-menu-right navbar-dropdown" aria-labelledby="UserDropdown">
              <div class="dropdown-header text-center">
                <p class="mb-1 mt-3 font-weight-semibold" id="userAdmin"></p>
                <p class="fw-light text-muted mb-0" id="userAdminEmail"></p>
              </div>

              <a class="dropdown-item"  id="sign-out"><i class="dropdown-item-icon mdi mdi-power text-primary me-2"></i>Sign Out</a>
            </div>
          </li>
        </ul>
        <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button" data-bs-toggle="offcanvas">
          <span class="mdi mdi-menu"></span>
        </button>
      </div>
    </nav>
    <!-- partial -->
    <div class="container-fluid page-body-wrapper">
      <!-- partial:../../partials/_settings-panel.html -->
      <div id="right-sidebar" class="settings-panel">
        <i class="settings-close ti-close"></i>
        <ul class="nav nav-tabs border-top" id="setting-panel" role="tablist">
          <li class="nav-item">
            <a class="nav-link active" id="todo-tab" data-bs-toggle="tab" href="#todo-section" role="tab" aria-controls="todo-section" aria-expanded="true">TO DO LIST</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="chats-tab" data-bs-toggle="tab" href="#chats-section" role="tab" aria-controls="chats-section">CHATS</a>
          </li>
        </ul>
        <div class="tab-content" id="setting-content">
          <div class="tab-pane fade show active scroll-wrapper" id="todo-section" role="tabpanel" aria-labelledby="todo-section">
            <div class="add-items d-flex px-3 mb-0">
              <form class="form w-100">
                <div class="form-group d-flex">
                  <input type="text" class="form-control todo-list-input" placeholder="Add To-do">
                  <button type="submit" class="add btn btn-primary todo-list-add-btn" id="add-task">Add</button>
                </div>
              </form>
            </div>
            <div class="list-wrapper px-3">
              <ul class="d-flex flex-column-reverse todo-list">
                <li>
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="checkbox" type="checkbox">
                      Team review meeting at 3.00 PM
                    </label>
                  </div>
                  <i class="remove ti-close"></i>
                </li>
                <li>
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="checkbox" type="checkbox">
                      Prepare for presentation
                    </label>
                  </div>
                  <i class="remove ti-close"></i>
                </li>
                <li>
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="checkbox" type="checkbox">
                      Resolve all the low priority tickets due today
                    </label>
                  </div>
                  <i class="remove ti-close"></i>
                </li>
                <li class="completed">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="checkbox" type="checkbox" checked>
                      Schedule meeting for next week
                    </label>
                  </div>
                  <i class="remove ti-close"></i>
                </li>
                <li class="completed">
                  <div class="form-check">
                    <label class="form-check-label">
                      <input class="checkbox" type="checkbox" checked>
                      Project review
                    </label>
                  </div>
                  <i class="remove ti-close"></i>
                </li>
              </ul>
            </div>
            <h4 class="px-3 text-muted mt-5 fw-light mb-0">Events</h4>
            <div class="events pt-4 px-3">
              <div class="wrapper d-flex mb-2">
                <i class="ti-control-record text-primary me-2"></i>
                <span>Feb 11 2018</span>
              </div>
              <p class="mb-0 font-weight-thin text-gray">Creating component page build a js</p>
              <p class="text-gray mb-0">The total number of sessions</p>
            </div>
            <div class="events pt-4 px-3">
              <div class="wrapper d-flex mb-2">
                <i class="ti-control-record text-primary me-2"></i>
                <span>Feb 7 2018</span>
              </div>
              <p class="mb-0 font-weight-thin text-gray">Meeting with Alisa</p>
              <p class="text-gray mb-0 ">Call Sarah Graves</p>
            </div>
          </div>
          <!-- To do section tab ends -->
          <div class="tab-pane fade" id="chats-section" role="tabpanel" aria-labelledby="chats-section">
            <div class="d-flex align-items-center justify-content-between border-bottom">
              <p class="settings-heading border-top-0 mb-3 pl-3 pt-0 border-bottom-0 pb-0">Friends</p>
              <small class="settings-heading border-top-0 mb-3 pt-0 border-bottom-0 pb-0 pr-3 fw-normal">See All</small>
            </div>
            <ul class="chat-list">
              <li class="list active">
                <div class="profile"><img src="../../images/faces/face1.jpg" alt="image"><span class="online"></span></div>
                <div class="info">
                  <p>Thomas Douglas</p>
                  <p>Available</p>
                </div>
                <small class="text-muted my-auto">19 min</small>
              </li>
              <li class="list">
                <div class="profile"><img src="../../images/faces/face2.jpg" alt="image"><span class="offline"></span></div>
                <div class="info">
                  <div class="wrapper d-flex">
                    <p>Catherine</p>
                  </div>
                  <p>Away</p>
                </div>
                <div class="badge badge-success badge-pill my-auto mx-2">4</div>
                <small class="text-muted my-auto">23 min</small>
              </li>
              <li class="list">
                <div class="profile"><img src="../../images/faces/face3.jpg" alt="image"><span class="online"></span></div>
                <div class="info">
                  <p>Daniel Russell</p>
                  <p>Available</p>
                </div>
                <small class="text-muted my-auto">14 min</small>
              </li>
              <li class="list">
                <div class="profile"><img src="../../images/faces/face4.jpg" alt="image"><span class="offline"></span></div>
                <div class="info">
                  <p>James Richardson</p>
                  <p>Away</p>
                </div>
                <small class="text-muted my-auto">2 min</small>
              </li>
              <li class="list">
                <div class="profile"><img src="../../images/faces/face5.jpg" alt="image"><span class="online"></span></div>
                <div class="info">
                  <p>Madeline Kennedy</p>
                  <p>Available</p>
                </div>
                <small class="text-muted my-auto">5 min</small>
              </li>
              <li class="list">
                <div class="profile"><img src="../../images/faces/face6.jpg" alt="image"><span class="online"></span></div>
                <div class="info">
                  <p>Sarah Graves</p>
                  <p>Available</p>
                </div>
                <small class="text-muted my-auto">47 min</small>
              </li>
            </ul>
          </div>
          <!-- chat tab ends -->
        </div>
      </div>
      <!-- partial -->
      <!-- partial:../../partials/_sidebar.html -->
      <nav class="sidebar sidebar-offcanvas" id="sidebar">
        <ul class="nav">
          <li class="nav-item">
            <a class="nav-link" href="../../bamos-dashb-welcome-page.html">
              <i class="mdi mdi-grid-large menu-icon"></i>
              <span class="menu-title">Dashboard</span>
            </a>
          </li>
          <li class="nav-item nav-category">Forms and Datas</li>
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="collapse" href="#form-elements" aria-expanded="false" aria-controls="form-elements">
              <i class="menu-icon mdi mdi-card-text-outline"></i>
              <span class="menu-title">Form</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="form-elements">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"><a class="nav-link" href="../../pages/forms/bamos-form-checking.html">Account Registration</a></li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="collapse" href="#charts" aria-expanded="false" aria-controls="charts">
              <i class="menu-icon mdi mdi-chart-line"></i>
              <span class="menu-title">Charts</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="charts">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"> <a class="nav-link" href="../../pages/charts/bamos-charts.html">See all charts</a></li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="collapse" href="#tables" aria-expanded="false" aria-controls="tables">
              <i class="menu-icon mdi mdi-table"></i>
              <span class="menu-title">Tables</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="tables">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"> <a class="nav-link" href="../../pages/tables/bamos-users.html">Users Activation</a></li>
                <li class="nav-item"> <a class="nav-link" href="../../pages/tables/bamos-user-info.html">Users Information</a></li>
              </ul>
            </div>
          </li>
        </ul>
      </nav>
      <!-- partial -->
      <div class="main-panel">
        <div class="content-wrapper">
          <div class="row">
            <!--- Export -->
            <div class="col-sm-12">
              <div class="home-tab">
                <div class="d-sm-flex align-items-center justify-content-between border-bottom">
                  <ul class="nav nav-tabs" role="tablist">
                    <li class="nav-item">
                      <h4 style="display: inline;">Select Sitio:</h4>
                      <select id="sitio-status" style="width: 200px;font-size: 18px;">
                        <option value="1">Sitio 1</option>
                        <option value="2">Sitio 2</option>
                        <option value="3">Sitio 3</option>
                        <option value="4">Sitio 4</option>
                      </select>
                    </li>
                  </ul>
                  <div>
                    <div class="btn-wrapper position-relative">
                      <a id="export" class="btn btn-otline-dark"><i class="icon-printer"></i> Export</a>
                      <ul class="position-absolute drop-print export">
                        <li>
                          <a href="gen-rep.html">All Charts</a>
                        </li>
                        
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- End Export -->
            <div id="chart-container" class="col-lg-6 grid-margin stretch-card gender-chart">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">
                    Employment Status By Gender &nbsp;&nbsp;&nbsp;&nbsp;
                  </h4>
                  <canvas id="barChart1" class="graph1"></canvas>
                </div>
              </div>
            </div>

            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Civil Status &nbsp;&nbsp;&nbsp;&nbsp;</h4>
                  <canvas id="barChart2"></canvas>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Resident Status  &nbsp;&nbsp;&nbsp;&nbsp;
                    <!-- select id="resident-status">
                      <option value="Current Resident">Current Resident</option>
                      <option value="Previous Resident">Previous Resident</option>
                      <option value="Deceased Resident">Deceased Resident</option>
                    </select -->
                  </h4>
                  <canvas id="barChart3"></canvas>
                </div>
              </div>
            </div>
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Employment </h4>
                  <canvas id="lineChart"></canvas>
                </div>
              </div>
            </div>
          </div>

        
          <div class="row">
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Bata/PWD  &nbsp;&nbsp;&nbsp;&nbsp;
                    <!-- select id="bata-pwd">
                      <option value="bata">Bata</option>
                      <option value="pwd">PWD</option>
                    </select -->
                  </h4>
                  <canvas id="barGraph1"></canvas>
                </div>
              </div>
            </div>
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Age</h4>
                  <canvas id="lineChart2"></canvas>
                </div>
              </div>
            </div>
          </div>
          
          <div class="row">
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Lupang Kinatatayuan  &nbsp;&nbsp;&nbsp;&nbsp;
                    <!-- select id="bata-pwd">
                      <option value="bata">Bata</option>
                      <option value="pwd">PWD</option>
                    </select -->
                  </h4>
                  <canvas id="lineChart3"></canvas>
                </div>
              </div>
            </div>
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Bahay na Tinitirhan</h4>
                  <canvas id="lineChart4"></canvas>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Lupang sakahan/pinagyayaman
                    <!-- select id="bata-pwd">
                      <option value="bata">Bata</option>
                      <option value="pwd">PWD</option>
                    </select -->
                  </h4>
                  <canvas id="lineChart5"></canvas>
                </div>
              </div>
            </div>
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Pinagkukunan ng Tubig</h4>
                  <canvas id="lineChart6"></canvas>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Pinagmumulan ng Elektrisidad
                    <!-- select id="bata-pwd">
                      <option value="bata">Bata</option>
                      <option value="pwd">PWD</option>
                    </select -->
                  </h4>
                  <canvas id="lineChart7"></canvas>
                </div>
              </div>
            </div>
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Uri ng Sasakyan</h4>
                  <canvas id="lineChart8"></canvas>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Pang komersyo
                    <!-- select id="bata-pwd">
                      <option value="bata">Bata</option>
                      <option value="pwd">PWD</option>
                    </select -->
                  </h4>
                  <canvas id="lineChart9"></canvas>
                </div>
              </div>
            </div>
            <div class="col-lg-6 grid-margin stretch-card">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">Uri ng palikuran</h4>
                  <canvas id="lineChart10"></canvas>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-lg-6 grid-margin stretch-card gender-chart">
              <div class="card">
                <div class="card-body">
                  <h4 class="card-title">
                    Gender &nbsp;&nbsp;&nbsp;&nbsp;
                  </h4>
                  <canvas id="barChart69" class="graph69"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>

        
      
        <!-- content-wrapper ends -->
        <!-- partial:../../partials/_footer.html -->
        <footer class="footer">
          <div class="d-sm-flex justify-content-center justify-content-sm-between">
            <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center">BAMOS Â© 2023. All rights reserved.</span>
          </div>
        </footer>
        <!-- partial -->
      </div>
      <!-- main-panel ends -->
    </div>
    <!-- page-body-wrapper ends -->
  </div>
<div class="printXL">
  <div class="row">

  </div>
</div>

  <!-- container-scroller -->
  <!-- plugins:js -->
  <script src="../../vendors/js/vendor.bundle.base.js"></script>
  <!-- endinject -->
  <!-- Plugin js for this page -->
  <script src="../../vendors/chart.js/Chart.min.js"></script>
  <script src="../../vendors/bootstrap-datepicker/bootstrap-datepicker.min.js"></script>
  
  <!-- End plugin js for this page -->
  <!-- inject:js -->
  <script src="../../js/off-canvas.js"></script>
  <script src="../../js/hoverable-collapse.js"></script>
  <script src="../../js/template.js"></script>
  <script src="../../js/settings.js"></script>
  <script src="../../js/todolist.js"></script>
  <!-- endinject -->
  <!-- Custom js for this page-->
  <script src="../../js/chart.js"></script>
  <script src="../../js/dashboard.js"></script>
  <!-- End custom js for this page-->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="../../js/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>

  <script>
    const supabaseUrl = 'https://hzyiqzmdkocpumguttzb.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh6eWlxem1ka29jcHVtZ3V0dHpiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDA1Mzc5OTMsImV4cCI6MjAxNjExMzk5M30.-JNHzAkpBh_EN99ZiYGbu1q4ZsRSE3WapgBRMPrkiZs';
    const database = supabase.createClient(supabaseUrl, supabaseKey);

    localStorage.setItem('sitio',2);

    async function getDataBarChart1(isEmployed = 1) {
      var data = [];

      

      if (localStorage.getItem('sitio') === undefined) {
        var { data, error } = await database.from('testing').select(`
          *,
          miyembro ( kasarian, Employed )
        `).eq('role', 2);
      } else {
        var { data, error } = await database.from('testing').select(`
          *,
          miyembro ( kasarian, Employed )
        `).eq('sitio', localStorage.getItem('sitio'));
      }

      var barData = [];
      barData['Male'] = 0;
      barData['Female'] = 0;
      barData['Prefer_not_to_say'] = 0;

      console.log('data', data);

      for(var x = 0; x < data.length; x++) {
        if(data[x].miyembro.length > 0) {
            for(var y = 0; y < data[x].miyembro.length; y++) {
              var isEmployee = data[x].miyembro[y].Employed;
              var gender = data[x].miyembro[y].kasarian;
              var condition = '';
              if(isEmployed == 1) {
                condition = 'isEmployee != null';
              } else {
                condition = 'isEmployee == null';
              }
              if(eval(condition)) {
                barData[gender] = barData[gender] + 1;
              }
            }
        }
      }

      var barChartData = {
        labels: ["Male", "Female", "Prefer not to say"],
        datasets: [{
          label: '# of Votes',
          data: [barData['Male'], barData['Female'], barData['Prefer_not_to_say']],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)'
          ],
          borderColor: [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)'
          ],
          borderWidth: 1,
          fill: false
        }]
      };
      var options = {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        },
        legend: {
          display: false
        },
        elements: {
          point: {
            radius: 0
          }
        }
      };

      barChart1(barChartData, options);
    }

    getDataBarChart1();

    $('#employment_status').change(function() {
      var value = $(this).val();
      getDataBarChart1(value);
    });


    function barChart1(data, options) {
      if ($("#barChart1").length) {
        var barChartCanvas = $("#barChart1").get(0).getContext("2d");
        if(window.bar != undefined)
        window.bar.destroy();
        window.bar = new Chart(barChartCanvas, {
          type: 'bar',
          data: data,
          options: options
        });
      }
    }

    async function getDataBarChart69(isEmployed = 1) {
      var data = [];

      

      if (localStorage.getItem('sitio') === undefined) {
        var { data, error } = await database.from('testing').select(`
          *,
          miyembro ( kasarian, Employed )
        `).eq('role', 2);
      } else {
        var { data, error } = await database.from('testing').select(`
          *,
          miyembro ( kasarian, Employed )
        `).eq('sitio', localStorage.getItem('sitio'));
      }

      console.log(data);

      var barData = [];
      barData['Male'] = 0;
      barData['Female'] = 0;
      barData['Prefer_not_to_say'] = 0;

      for(var x = 0; x < data.length; x++) {
        if(data[x].miyembro.length > 0) {
            for(var y = 0; y < data[x].miyembro.length; y++) {
              var isEmployee = data[x].miyembro[y].Employed;
              var gender = data[x].miyembro[y].kasarian;
              
                barData[gender] = barData[gender] + 1;
            }
        }
      }

      var barChartData = {
        labels: ["Male", "Female", "Prefer not to say"],
        datasets: [{
          label: '# of Votes',
          data: [barData['Male'], barData['Female'], barData['Prefer_not_to_say']],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)'
          ],
          borderColor: [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)'
          ],
          borderWidth: 1,
          fill: false
        }]
      };
      var options = {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        },
        legend: {
          display: false
        },
        elements: {
          point: {
            radius: 0
          }
        }
      };

      barChart69(barChartData, options);
    }

    getDataBarChart69();

    function barChart69(data, options) {
      if ($("#barChart69").length) {
        var barChartCanvas = $("#barChart69").get(0).getContext("2d");
        if(window.bar69 != undefined)
        window.bar69.destroy();
        window.bar69 = new Chart(barChartCanvas, {
          type: 'bar',
          data: data,
          options: options
        });
      }
    }

    

    async function getDataBarChart2() {
      var data = [];

      if (localStorage.getItem('sitio') === undefined) {
        var { data, error } = await database.from('testing').select().eq('role', 2);
      } else {
        var { data, error } = await database.from('testing').select().eq('sitio', localStorage.getItem('sitio'));
      }

      var barData = [];
      barData['Single'] = 0;
      barData['Married'] = 0;
      barData['Widowed'] = 0;

      for(var x = 0; x < data.length; x++) {
        var civilStatus = data[x].civilStatus;
        barData[civilStatus] = barData[civilStatus] + 1;
      }

      var barChartData = {
        labels: ["Single", "Married", "Widowed"],
        datasets: [{
          label: '# of Votes',
          data: [barData['Single'], barData['Married'], barData['Widowed']],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)'
          ],
          borderColor: [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)'
          ],
          borderWidth: 1,
          fill: false
        }]
      };
      var options = {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        },
        legend: {
          display: false
        },
        elements: {
          point: {
            radius: 0
          }
        },
      };

      barChart2(barChartData, options);
    }

    getDataBarChart2();

    function barChart2(data, options) {
      if ($("#barChart2").length) {
        var barChartCanvas = $("#barChart2").get(0).getContext("2d");
        if(window.bar2 != undefined)
        window.bar2.destroy();
        window.bar2 = new Chart(barChartCanvas, {
          type: 'bar',
          data: data,
          options: options
        });
      }
    }

    async function getDataBarChart3(residentStatusVal = 'Current Resident') {
      var data = [];

      if (localStorage.getItem('sitio') === undefined) {
        var { data, error } = await database.from('testing').select().eq('role', 2);
      } else {
        var { data, error } = await database.from('testing').select().eq('sitio', localStorage.getItem('sitio'));
      }
      

      var barData = [];
      barData['Current Resident'] = 0;
      barData['Previous Resident'] = 0;
      //barData['Deceased Resident'] = 0;

      for(var x = 0; x < data.length; x++) {
          var residentStatus = data[x].residentStatus;
          barData[residentStatus] = barData[residentStatus] + 1;
      }

      console.log('barData', barData);

      var barChartData = {
        labels: ['Current Resident','Previous Resident'],
        datasets: [{
          label: '# of Votes',
          data: [barData['Current Resident'],barData['Previous Resident']],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)'
          ],
          borderColor: [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)'
          ],
          borderWidth: 1,
          fill: false,
        }]
      };
      var options = {
        scales: {
          yAxes: [{
            ticks: {
            beginAtZero: true
            }
          }]
        },
        legend: {
          display: false
        },
        elements: {
          point: {
            radius: 0
          }
        },
        
      };

      barChart3(barChartData, options);
    }

    getDataBarChart3();

    $('#resident-status').change(function() {
      var value = $(this).val();
      getDataBarChart3(value);
    });

    
    function barChart3(data, options) {
      if ($("#barChart3").length) {
        var barChartCanvas = $("#barChart3").get(0).getContext("2d");
        if(window.bar3 != undefined)
        window.bar3.destroy();
        // This will get the first returned node in the jQuery collection.
        window.bar3 = new Chart(barChartCanvas, {
          type: 'bar',
          data: data,
          options: options
        });
      }
    }


    $('#sitio-status').change(function() {
      var value = $(this).val();
      localStorage.setItem('sitio',value);
      getDataBarChart1();
      getDataBarChart69();
      getDataBarChart2();
      getDataBarChart3();
      getDataLineChart();
      getDataLineChart2();
      getDataLineChart3();
      getDataLineChart4();
      getDataLineChart5();
      getDataLineChart6();
      getDataLineChart7();
      getDataLineChart8();
      getDataLineChart9();
      getDataLineChart10();
      bataPWD();
    });


    async function getDataLineChart() {
      var data = [];

      if (localStorage.getItem('sitio') === undefined) {
        var { data, error } = await database.from('testing').select('*, miyembro ( * )').eq('role', 2);
      } else {
        var { data, error } = await database.from('testing').select('*, miyembro ( * )').eq('sitio', localStorage.getItem('sitio'));
      }

      var barData = [];
      barData['Employed'] = 0;
      barData['Unemployed'] = 0;

      for(var x = 0; x < data.length; x++) {
          var Family_members = data[x].miyembro;
          for(var y = 0; y < data[x].miyembro.length; y++) {
            family_mem = Family_members[y].Family_members;
            for(var z = 0; z < family_mem.length; z++) {
              if (family_mem[z].additionalEmployment !== undefined) {
                barData[family_mem[z].additionalEmployment] += 1;
              }
              
            }
            
          }
      }

      var lineChartData = {
        labels: ['Employed','Unemployed'],
        datasets: [{
          label: '# of Votes',
          data: [barData['Employed'],barData['Unemployed']],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)'
          ],
          borderColor: [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)'
          ],
          borderWidth: 1,
          fill: false
        }]
      };
      var options = {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        },
        legend: {
          display: false
        },
        elements: {
          point: {
            radius: 0
          }
        }
      };

      lineChart(lineChartData, options);
    }

    getDataLineChart();

    function lineChart(data, options) {
      if ($("#lineChart").length) {
        var lineChartCanvas = $("#lineChart").get(0).getContext("2d");
        // This will get the first returned node in the jQuery collection.
        if(window.bar4 != undefined)
        window.bar4.destroy();
        window.bar4 = new Chart(lineChartCanvas, {
          type: 'bar',
          data: data,
          options: options
        });
      }
    }


    async function getDataLineChart2() {
      var data = [];

      if (localStorage.getItem('sitio') === undefined) {
        var { data, error } = await database.from('testing').select('*, nutrisyon ( * )').eq('role', 2);
      } else {
        var { data, error } = await database.from('testing').select('*, nutrisyon ( * )').eq('sitio', localStorage.getItem('sitio'));
      }

      var barData = [];
      barData['Infant'] = 0;
      barData['Child'] = 0;
      barData['Adult'] = 0;

      for(var x = 0; x < data.length; x++) {
          var Family_members = data[x].nutrisyon;
          for(var y = 0; y < data[x].nutrisyon.length; y++) {
            family_mem = Family_members[y].Family_members;
            for(var z = 0; z < family_mem.length; z++) {
              if (family_mem[z].age !== undefined) {
                if (family_mem[z].age <= 0) {
                  barData['Infant'] += 1;
                } else if (family_mem[z].age >= 18) {
                  barData['Child'] += 1;
                } else {
                  barData['Adult'] += 1;
                }
                
              }
              
            }
            
          }
      }

      var lineChartData = {
        labels: ['Infant','Child','Adult'],
        datasets: [{
          label: '# of Votes',
          data: [barData['Infant'],barData['Child'],barData['Adult']],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)'
          ],
          borderColor: [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)'
          ],
          borderWidth: 1,
          fill: false
        }]
      };
      var options = {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        },
        legend: {
          display: false
        },
        elements: {
          point: {
            radius: 0
          }
        }
      };

      lineChart2(lineChartData, options);
    }


    getDataLineChart2();
   
    function lineChart2(data, options) {
      if ($("#lineChart2").length) {
        var lineChartCanvas = $("#lineChart2").get(0).getContext("2d");
        // This will get the first returned node in the jQuery collection.
        if(window.bar6 != undefined)
        window.bar6.destroy();
        window.bar6 = new Chart(lineChartCanvas, {
          type: 'bar',
          data: data,
          options: options
        });
      }
    }

    async function getDataLineChart3() {
      var data = [];

      if (localStorage.getItem('sitio') === undefined) {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('role', 2);
      } else {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('sitio', localStorage.getItem('sitio'));
      }

      var barData = [];
      barData['pag aari'] = 0;
      barData['Inuupahan'] = 0;
      barData['Iba_pa'] = 0;

      for(var x = 0; x < data.length; x++) {
        var Family_members = data[x].pangkabuhayan;
        for(var y = 0; y < data[x].pangkabuhayan.length; y++) {
            family_mem = Family_members[y].LupangKinatatayuan;
            barData[family_mem] += 1;
        }
          
          
      }

      var lineChartData = {
        labels: ['pag aari','inuupahan','iba pa'],
        datasets: [{
          label: '# of Votes',
          data: [barData['pag aari'],barData['Inuupahan'],barData['Iba_pa']],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)'
          ],
          borderColor: [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)'
          ],
          borderWidth: 1,
          fill: false
        }]
      };
      var options = {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        },
        legend: {
          display: false
        },
        elements: {
          point: {
            radius: 0
          }
        }
      };

      lineChart3(lineChartData, options);
    }

    getDataLineChart3();

    function lineChart3(data, options) {
      if ($("#lineChart3").length) {
        var lineChartCanvas = $("#lineChart3").get(0).getContext("2d");
        // This will get the first returned node in the jQuery collection.
        if(window.bar7 != undefined)
        window.bar7.destroy();
        window.bar7 = new Chart(lineChartCanvas, {
          type: 'bar',
          data: data,
          options: options
        });
      }
    }


    async function getDataLineChart4() {
      var data = [];

      if (localStorage.getItem('sitio') === undefined) {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('role', 2);
      } else {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('sitio', localStorage.getItem('sitio'));
      }

      var barData = [];
      barData['Pag-aari'] = 0;
      barData['Inuupahan'] = 0;
      barData['Iba_Pa'] = 0;

      for(var x = 0; x < data.length; x++) {
        var Family_members = data[x].pangkabuhayan;
        for(var y = 0; y < data[x].pangkabuhayan.length; y++) {
            family_mem = Family_members[y].BahaynaTinitirhan;
            barData[family_mem] += 1;
        }
      }

      var lineChartData = {
        labels: ['pag aari','inuupahan','iba pa'],
        datasets: [{
          label: '# of Votes',
          data: [barData['Pag-aari'],barData['Inuupahan'],barData['Iba_Pa']],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)'
          ],
          borderColor: [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)'
          ],
          borderWidth: 1,
          fill: false
        }]
      };
      var options = {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        },
        legend: {
          display: false
        },
        elements: {
          point: {
            radius: 0
          }
        }
      };

      lineChart4(lineChartData, options);
    }

    getDataLineChart4();

    function lineChart4(data, options) {
      if ($("#lineChart4").length) {
        var lineChartCanvas = $("#lineChart4").get(0).getContext("2d");
        // This will get the first returned node in the jQuery collection.
        if(window.bar8 != undefined)
        window.bar8.destroy();
        window.bar8 = new Chart(lineChartCanvas, {
          type: 'bar',
          data: data,
          options: options
        });
      }
    }


    async function getDataLineChart5() {
      var data = [];

      if (localStorage.getItem('sitio') === undefined) {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('role', 2);
      } else {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('sitio', localStorage.getItem('sitio'));
      }

      var barData = [];
      barData['Pag-aari'] = 0;
      barData['Inuupahan'] = 0;
      barData['Iba_Pa'] = 0;

      for(var x = 0; x < data.length; x++) {
        var Family_members = data[x].pangkabuhayan;
        for(var y = 0; y < data[x].pangkabuhayan.length; y++) {
            family_mem = Family_members[y].LupangSakahanPinagyayaman;
            barData[family_mem] += 1;
        }
      }

      var lineChartData = {
        labels: ['pag aari','inuupahan','iba pa'],
        datasets: [{
          label: '# of Votes',
          data: [barData['Pag-aari'],barData['Inuupahan'],barData['Iba_Pa']],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)'
          ],
          borderColor: [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)'
          ],
          borderWidth: 1,
          fill: false
        }]
      };
      var options = {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        },
        legend: {
          display: false
        },
        elements: {
          point: {
            radius: 0
          }
        }
      };

      lineChart5(lineChartData, options);
    }

    getDataLineChart5();

    function lineChart5(data, options) {
      if ($("#lineChart5").length) {
        var lineChartCanvas = $("#lineChart5").get(0).getContext("2d");
        // This will get the first returned node in the jQuery collection.
        if(window.bar9 != undefined)
        window.bar9.destroy();
        window.bar9 = new Chart(lineChartCanvas, {
          type: 'bar',
          data: data,
          options: options
        });
      }
    }


    async function getDataLineChart6() {
      var data = [];

      if (localStorage.getItem('sitio') === undefined) {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('role', 2);
      } else {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('sitio', localStorage.getItem('sitio'));
      }

      var barData = [];
      barData['Poso Artesiano'] = 0;
      barData['NAWASA'] = 0;
      barData['Balon'] = 0;
      barData['Iba_Pa'] = 0;

      for(var x = 0; x < data.length; x++) {
        var Family_members = data[x].pangkabuhayan;
        for(var y = 0; y < data[x].pangkabuhayan.length; y++) {
            family_mem = Family_members[y].PinagkukunanngTubig;
            barData[family_mem] += 1;
        }
      }

      var lineChartData = {
        labels: ['poso','nawasa','balon','iba pa'],
        datasets: [{
          label: '# of Votes',
          data: [barData['Poso Artesiano'],barData['NAWASA'],barData['Balon'],barData['Iba_Pa']],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)'
          ],
          borderColor: [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)'
          ],
          borderWidth: 1,
          fill: false
        }]
      };
      var options = {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        },
        legend: {
          display: false
        },
        elements: {
          point: {
            radius: 0
          }
        }
      };

      lineChart6(lineChartData, options);
    }

    getDataLineChart6();

    function lineChart6(data, options) {
      if ($("#lineChart6").length) {
        var lineChartCanvas = $("#lineChart6").get(0).getContext("2d");
        // This will get the first returned node in the jQuery collection.
        if(window.bar10 != undefined)
        window.bar10.destroy();
        window.bar10 = new Chart(lineChartCanvas, {
          type: 'bar',
          data: data,
          options: options
        });
      }
    }

    async function getDataLineChart7() {
      var data = [];

      if (localStorage.getItem('sitio') === undefined) {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('role', 2);
      } else {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('sitio', localStorage.getItem('sitio'));
      }

      var barData = [];
      barData['Kuryente'] = 0;
      barData['Gaas'] = 0;
      barData['Iba_Pa'] = 0;

      for(var x = 0; x < data.length; x++) {
        var Family_members = data[x].pangkabuhayan;
        for(var y = 0; y < data[x].pangkabuhayan.length; y++) {
            family_mem = Family_members[y].PinagmumulanngElektrisidad;
            barData[family_mem] += 1;
        }
      }

      var lineChartData = {
        labels: ['kuryente','gaas','iba pa'],
        datasets: [{
          label: '# of Votes',
          data: [barData['Kuryente'],barData['Gaas'],barData['Iba_Pa']],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)'
          ],
          borderColor: [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)'
          ],
          borderWidth: 1,
          fill: false
        }]
      };
      var options = {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        },
        legend: {
          display: false
        },
        elements: {
          point: {
            radius: 0
          }
        }
      };

      lineChart7(lineChartData, options);
    }

    getDataLineChart7();

    function lineChart7(data, options) {
      if ($("#lineChart7").length) {
        var lineChartCanvas = $("#lineChart7").get(0).getContext("2d");
        // This will get the first returned node in the jQuery collection.
        if(window.bar11 != undefined)
        window.bar11.destroy();
        window.bar11 = new Chart(lineChartCanvas, {
          type: 'bar',
          data: data,
          options: options
        });
      }
    }


    async function getDataLineChart8() {
      var data = [];

      if (localStorage.getItem('sitio') === undefined) {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('role', 2);
      } else {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('sitio', localStorage.getItem('sitio'));
      }

      var barData = [];
      barData['Kotse'] = 0;
      barData['Jeep'] = 0;
      barData['Motorsiklo'] = 0;
      barData['Van'] = 0;
      barData['Truck'] = 0;

      for(var x = 0; x < data.length; x++) {
        var Family_members = data[x].pangkabuhayan;
        for(var y = 0; y < data[x].pangkabuhayan.length; y++) {
            family_mem = Family_members[y].sasakyan;
            barData[family_mem] += 1;
        }
      }

      var lineChartData = {
        labels: ['kotse','jeep','motorsiklo','van','truck'],
        datasets: [{
          label: '# of Votes',
          data: [
            barData['Kotse'],
            barData['Jeep'],
            barData['Motorsiklo'],
            barData['Van'],
            barData['Truck']
          ],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)'
          ],
          borderColor: [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)'
          ],
          borderWidth: 1,
          fill: false
        }]
      };
      var options = {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        },
        legend: {
          display: false
        },
        elements: {
          point: {
            radius: 0
          }
        }
      };

      lineChart8(lineChartData, options);
    }

    getDataLineChart8();

    function lineChart8(data, options) {
      if ($("#lineChart8").length) {
        var lineChartCanvas = $("#lineChart8").get(0).getContext("2d");
        // This will get the first returned node in the jQuery collection.
        if(window.bar12 != undefined)
        window.bar12.destroy();
        window.bar12 = new Chart(lineChartCanvas, {
          type: 'bar',
          data: data,
          options: options
        });
      }
    }

    async function getDataLineChart9() {
      var data = [];

      if (localStorage.getItem('sitio') === undefined) {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('role', 2);
      } else {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('sitio', localStorage.getItem('sitio'));
      }

      var barData = [];
      barData['Babuyan'] = 0;
      barData['Manukan'] = 0;
      barData['Itikan'] = 0;
      barData['Bakahan'] = 0;
      barData['Iba_Pa'] = 0;

      for(var x = 0; x < data.length; x++) {
        var Family_members = data[x].pangkabuhayan;
        for(var y = 0; y < data[x].pangkabuhayan.length; y++) {
            family_mem = Family_members[y].PangKomersiyo;
            barData[family_mem] += 1;
        }
      }

      var lineChartData = {
        labels: ['babuyan',
          'manukan',
          'itikan',
          'bakahan',
          ' iba pa'],
        datasets: [{
          label: '# of Votes',
          data: [
            barData['Babuyan'],
      barData['Manukan'],
      barData['Itikan'],
      barData['Bakahan'],
      barData['Iba_Pa']
          ],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)'
          ],
          borderColor: [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)'
          ],
          borderWidth: 1,
          fill: false
        }]
      };
      var options = {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        },
        legend: {
          display: false
        },
        elements: {
          point: {
            radius: 0
          }
        }
      };

      lineChart9(lineChartData, options);
    }

    getDataLineChart9();

    function lineChart9(data, options) {
      if ($("#lineChart9").length) {
        var lineChartCanvas = $("#lineChart9").get(0).getContext("2d");
        // This will get the first returned node in the jQuery collection.
        if(window.bar13 != undefined)
        window.bar13.destroy();
        window.bar13 = new Chart(lineChartCanvas, {
          type: 'bar',
          data: data,
          options: options
        });
      }
    }

    async function getDataLineChart10() {
      var data = [];

      if (localStorage.getItem('sitio') === undefined) {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('role', 2);
      } else {
        var { data, error } = await database.from('testing').select('*, pangkabuhayan ( * )').eq('sitio', localStorage.getItem('sitio'));
      }

      var barData = [];
      barData['Flush'] = 0;
      barData['DeBuhos'] = 0;
      barData['Hinukay'] = 0;
      barData['Iba_Pa'] = 0;


      for(var x = 0; x < data.length; x++) {
        var Family_members = data[x].pangkabuhayan;
        for(var y = 0; y < data[x].pangkabuhayan.length; y++) {
            family_mem = Family_members[y].UringPalikuran;
            barData[family_mem] += 1;
        }
      }

      var lineChartData = {
        labels: ['flush',
          'de buhos',
          'hukay'],
        datasets: [{
          label: '# of Votes',
          data: [
            barData['Flush'],
            barData['DeBuhos'],
            barData['Hinukay'],
            barData['Iba_Pa']
          ],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)'
          ],
          borderColor: [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)'
          ],
          borderWidth: 1,
          fill: false
        }]
      };
      var options = {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        },
        legend: {
          display: false
        },
        elements: {
          point: {
            radius: 0
          }
        }
      };

      lineChart10(lineChartData, options);
    }

    getDataLineChart10();

    function lineChart10(data, options) {
      if ($("#lineChart10").length) {
        var lineChartCanvas = $("#lineChart10").get(0).getContext("2d");
        // This will get the first returned node in the jQuery collection.
        if(window.bar14 != undefined)
        window.bar14.destroy();
        window.bar14 = new Chart(lineChartCanvas, {
          type: 'bar',
          data: data,
          options: options
        });
      }
    }

    async function bataPWD(type="bata") {
      
      if (localStorage.getItem('sitio') === undefined) {
        var { data, error } = await database.from('testing').select(`
            *,
            kalusuganBuntis ( * ),
            kalusuganPWD ( * ),
            miyembro ( * ),
            nutrisyon ( * ),
            pangkabuhayan ( * ),
            panlipunan ( * )
          `).eq('role',2);
        
      } else {
        var { data, error } = await database.from('testing').select(`
            *,
            kalusuganBuntis ( * ),
            kalusuganPWD ( * ),
            miyembro ( * ),
            nutrisyon ( * ),
            pangkabuhayan ( * ),
            panlipunan ( * )
          `).eq('sitio', localStorage.getItem('sitio'));
      }
      

      var barData = {};
      var html = '';

      barData['bata'] = 0;
      barData['pwd'] = 0;

      for(var x = 0; x < data.length; x++) {
        if(data[x].sitio) {
            var sitio = data[x].sitio;
            if(type == 'bata') {
              if(data[x].nutrisyon[0]?.Family_members != null) {
                  if(data[x].nutrisyon[0]?.Family_members.length > 0) {
                      for(var y = 0; y < data[x].nutrisyon[0]?.Family_members.length; y++) {
                          barData['bata'] += 1; 
                      }
                  } 
              } 
            } else {
              if(data[x].kalusuganPWD[0]?.Family_members != null) {
                  if(data[x].kalusuganPWD[0]?.Family_members.length > 0) {
                      for(var y = 0; y < data[x].kalusuganPWD[0]?.Family_members.length; y++) {
                          barData['pwd'] += 1; 
                      }
                  }
              }
            }
        }
      }

      var bataPWDChartData = {
        labels: ['pwd','bata'],
        datasets: [{
          label: '# of Votes',
          data: [barData['pwd'], barData['bata']],
          backgroundColor: [
            'rgba(255, 99, 132, 0.2)',
            'rgba(54, 162, 235, 0.2)',
            'rgba(255, 206, 86, 0.2)'
          ],
          borderColor: [
            'rgba(255,99,132,1)',
            'rgba(54, 162, 235, 1)',
            'rgba(255, 206, 86, 1)'
          ],
          borderWidth: 1,
          fill: false
        }]
      };
      var options = {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        },
        legend: {
          display: false
        },
        elements: {
          point: {
            radius: 0
          }
        }
      };

      bataPWDLineChart(bataPWDChartData, options);

    }

    bataPWD();

    $('#bata-pwd').change(function() {
      var value = $(this).val();
      bataPWD(value);
    });

    function bataPWDLineChart(data, options) {
      if ($("#barGraph1").length) {
        var barGraph1Canvas = $("#barGraph1").get(0).getContext("2d");
        if(window.bar5 != undefined)
        window.bar5.destroy();
        window.bar5 = new Chart(barGraph1Canvas, {
          type: 'bar',
          data: data,
          options: options
        });
      }
    }
  </script>

  <script>
    $('.stretch-card').each(function(key, card){
      const graphName = $(card).find('h4').clone().children().remove().end().text().trim();
      $('.drop-print').append(`<li><a data-graph="${key}" href="#">${graphName}</a></li>`);
    });


    $('#export').click(function() {
      $('.drop-print').toggleClass('open');
    });

    $('.drop-print li a').click(function(e) {
      e.preventDefault();
      $('.drop-print').toggleClass('open');
      pdfS($(this).data('graph'), $(this).text());
    });

    function pdfS(graph, filename) {
      var canvases = $('canvas');
      if (graph) {
          var title = $(canvases)[graph].previousElementSibling;
          
          var fTitle = $(title).clone().children().remove().end().text().trim();

          html = `
            <div class="col-12">
              <br>
              <br>
              <h4>${fTitle}</h4>
              <img src="${canvases[0].toDataURL()}" />
              <br>          
            </div>
          `

          $('.printXL .row').append(html);
      } else {
        $(canvases).each(function(key, canvas){
          var title = canvas.previousElementSibling;
          
          var fTitle = $(title).clone().children().remove().end().text().trim();

          var img = new Image();
          img.src = canvas.toDataURL();

          html = `
            <div class="col-12">
              <br>
              <br>
              <h4>${fTitle}</h4>
              <img src="${canvas.toDataURL()}" />
              <br>          
            </div>
          `

          $('.printXL .row').append(html);
        });
      }
      

     
        var pdf = new jsPDF('p', 'pt', 'letter');
        source = $('.printXL')[0];
        specialElementHandlers = {
            '#bypassme': function (element, renderer) {
                return true
            }
        };
        
        margins = {
            top: 80,
            bottom: 60,
            left: 40,
            width: 200
        };

        

        pdf.fromHTML(
            source, // HTML string or DOM elem ref.
            40, // x coord
            40, { // y coord
                'width': 170, // max width of content on PDF
                'elementHandlers': specialElementHandlers
            },

            function (dispose) {
                // dispose: object with X, Y of the last line add to the PDF 
                //          this allow the insertion of new lines after html
                const timeStamp = new Date().toLocaleString('en-US', {year: 'numeric', month: 'numeric', day: 'numeric'}).trim();
                pdf.save(`${filename}-${timeStamp}.pdf`);
                $('.printXL .row').html('');
            }, margins
        );
                
    }
    
  </script>
  <style>
    .printXL {
      max-width: 600px;
      padding: 2rem;
    }
    .printXL h4,img {
      max-width: 100%;
    }
  </style>
</body>

</html>
